<!DOCTYPE html>
<html>
<head>
    {% load static %}
    <title>Disha Media</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="{% static 'images/dishamedia-logo-text.png' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        :root {
            --font-size-base: 16px;
            --font-size-h1: 2.5rem;
            --font-size-h2: 2rem;
            --font-size-h3: 1.5rem;
            --font-size-p: 1rem;
            --container-padding: 20px;
        }

        @media (max-width: 768px) {
            :root {
                --font-size-base: 14px;
                --font-size-h1: 2rem;
                --font-size-h2: 1.75rem;
                --font-size-h3: 1.25rem;
                --font-size-p: 0.9rem;
                --container-padding: 15px;
            }
        }

        html {
            font-size: var(--font-size-base);
            line-height: 1.6;
        }

        body {
            font-size: var(--font-size-p);
            overflow-x: hidden;
        }

        h1 { font-size: var(--font-size-h1); }
        h2 { font-size: var(--font-size-h2); }
        h3 { font-size: var(--font-size-h3); }
        p { font-size: var(--font-size-p); }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--container-padding);
        }
    </style>
</head>
<body>

<nav class="navbar">
    <a href="/" class="logo" style="display: flex; align-items: center; height: 100%;overflow: visible;">
        <img src="{% static 'images/dishamedia-logo.png' %}" alt="Disha Media" style="scale: 1.5;height: 70px; width: auto; max-width: 280px; object-fit: contain;">
    </a>
    <button class="hamburger" id="hamburger" aria-label="Menu">
        <i class="fas fa-bars"></i>
        <i class="fas fa-times close-icon"></i>
    </button>
    <ul class="nav-menu" id="navMenu">
        <li class="nav-item"><a href="{% url 'web:home' %}">Home</a></li>
        <li class="nav-item"><a href="{% url 'web:gallery' %}">Gallery</a></li>
        <li class="nav-item"><a href="{% url 'web:news' %}">News</a></li>
        <li class="nav-item"><a href="{% url 'web:contact' %}">Contact</a></li>
        <li class="nav-item"><a href="#" id="addButton" class="add-button">Add</a></li>
    </ul>
</nav>

<style>
    /* Responsive Navbar */
    .hamburger {
        display: none;
        cursor: pointer;
        padding: 15px 10px;
        margin-left: auto;
        position: relative;
        z-index: 1001;
        background: none;
        border: none;
        color: #ffffff; /* Purple color for the hamburger icon */
    }

    .hamburger .fa-bars {
        display: block;
        font-size: 24px;
        transition: opacity 0.3s ease;
    }
    
    .hamburger .close-icon {
        display: none;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 24px;
        color: #fff;
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    .hamburger:hover .close-icon {
        color: #ffffff;
    }
    
    .hamburger.active .fa-bars {
        display: none;
    }
    
    .hamburger.active .close-icon {
        display: block;
        opacity: 1;
    }

    .nav-menu {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 2rem;
    }

    .nav-item {
        list-style: none;
    }

    .nav-item a {
        color: #ffffff;  /* White color for desktop */
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
    }

    .nav-item a:hover {
        color: #ffffff;
    }

    @media (max-width: 768px) {
        .nav-item a {
            color: #333;  /* Dark color for mobile */
        }
        
        .navbar {
            padding: 8px 15px;
            height: 70px;
        }
        .logo img {
            height: 60px !important;
            max-width: 250px !important;
            margin-left: -20px;
        }
        .hamburger {
            display: block;
        }
        
        .navbar {
            padding: 1rem 5%;
            position: relative;
            align-items: center;
            min-height: 85px;
            display: flex;
        }

        .hamburger {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 10px;
            margin-left: auto;
        }
        
        .logo {
            display: flex;
            align-items: center;
            height: 100%;
        }
        
        .logo img {
            height: 50px;
            width: auto;
            object-fit: contain;
            margin-top: 5px; /* Move logo slightly down */
        }

        .nav-menu {
            position: fixed;
            left: -100%;
            top: 70px;
            gap: 0;
            flex-direction: column;
            background-color: #ffffff;  /* Changed to white background */
            width: 100%;
            text-align: center;
            transition: 0.3s;
            padding: 1rem 0;
            z-index: 999;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);  /* Added subtle shadow */
        }

        .nav-item {
            margin: 16px 0;
            width: 100%;
        }

        .nav-menu.active {
            left: 0;
        }
    }

    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        backdrop-filter: blur(5px);
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
    }
    .modal-overlay.active {
        display: flex;
        opacity: 1;
        animation: fadeIn 0.3s ease-out;
    }
    .modal-container {
        background: white;
        padding: 2.5rem;
        border-radius: 16px;
        width: 90%;
        max-width: 400px;
        text-align: center;
        box-shadow: 0 10px 50px rgba(106, 17, 203, 0.3);
        transform: translateY(-20px);
        opacity: 0;
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .modal-overlay.active .modal-container {
        transform: translateY(0);
        opacity: 1;
    }
    .modal-header h3 {
        margin: 0;
        color: #2d3748;
        font-size: 1.5rem;
        font-weight: 700;
        background: linear-gradient(90deg, #6a11cb 0%, #2575fc 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 1.5rem;
    }
    .modal-input {
        width: 100%;
        padding: 1rem;
        margin-bottom: 1.5rem;
        border: 2px solid #e2e8f0;
        border-radius: 10px;
        font-size: 1rem;
        transition: all 0.3s ease;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }
    .modal-input:focus {
        outline: none;
        border-color: #6a11cb;
        box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.2);
        transform: translateY(-2px);
    }
    .modal-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 1rem;
    }
    .btn {
        padding: 0.75rem 1.75rem;
        border-radius: 50px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        font-size: 0.95rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
    }
    .btn-primary {
        background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
        color: white;
        box-shadow: 0 4px 15px rgba(106, 17, 203, 0.3);
    }
    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 7px 20px rgba(106, 17, 203, 0.4);
    }
    .btn-primary:active {
        transform: translateY(0);
    }
    .btn-secondary {
        background: #f1f5f9;
        color: #4a5568;
    }
    .btn-secondary:hover {
        background: #e2e8f0;
        transform: translateY(-2px);
    }
    .error-message {
        color: #e53e3e;
        margin: 1rem 0 0;
        display: none;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        font-size: 0.9rem;
        animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
    }
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    @keyframes shake {
        10%, 90% { transform: translate3d(-1px, 0, 0); }
        20%, 80% { transform: translate3d(2px, 0, 0); }
        30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
        40%, 60% { transform: translate3d(4px, 0, 0); }
    }
</style>

<div id="secretModal" class="modal-overlay">
    <div class="modal-container">
        <div class="modal-header">
            <h3><i class="fas fa-lock" style="margin-right: 8px;"></i> Admin Access</h3>
        </div>
        <input type="password" 
               id="secretCode" 
               class="modal-input" 
               placeholder="Enter your secret code" 
               onkeypress="if(event.key === 'Enter') checkCode()">
        <div class="modal-buttons">
            <button onclick="checkCode()" class="btn btn-primary">
                <i class="fas fa-check"></i> Submit
            </button>
            <button onclick="closeModal()" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
        <p id="errorMsg" class="error-message">
            <i class="fas fa-exclamation-circle"></i> Incorrect code, please try again
        </p>
    </div>
</div>

<div class="content">
    {% block content %}
    {% endblock %}
</div>

<footer class="footer" style="background: #1a1a2e; color: #fff; padding: 60px 0 30px;">
    <div class="container" style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; margin-bottom: 40px;">
            <div class="footer-about">
                <div style="margin-bottom: 0px;">
                    <img src="{% static 'images/dishamedia-logo.png' %}" alt="Disha Media" style="max-width: 170px; height: auto;margin-top: -27px;margin-left: -21px;">
                </div>
                <p style="color: #a0a0b0; line-height: 1.7; margin: 0; margin-top: -27px; margin-bottom: 15px;">The official digital media platform of Chennamangaloor HSS, bringing you the latest updates and news from our school community.</p>
                <div style="padding-top: 15px; margin-top: 15px; border-top: 1px solid rgba(255, 255, 255, 0.05);">
                    <div style="display: flex; flex-direction: column; align-items: flex-start; gap: 8px;">
                        <div style="font-size: 0.8rem; color: #a0a0b0; margin-bottom: 5px;">Powered by</div>
                        <div style="background: rgba(245, 243, 255, 0.15); border-radius: 6px; padding: 8px 12px; display: inline-flex; align-items: center; justify-content: center; height: 40px; box-sizing: border-box;">
                            <a href="https://grasped.pythonanywhere.com" target="_blank" rel="noopener noreferrer" style="text-decoration: none; display: flex; align-items: center; justify-content: center; height: 100%;">
                                <img src="{% static 'images/GraspEd-logo-text.png' %}" alt="GraspEd" style="height: 22px; width: auto; opacity: 0.9; display: block;">
                            </a>
                        </div>
                        <div style="font-size: 0.75rem; color: #8a8a9a; margin: 4px 0;">Developed by Muhammed Nafil N</div>
                        <div style="display: flex; align-items: center; gap: 8px; margin: 2px 0 6px 0;">
                            <span style="font-size: 0.7rem; color: #a0a0b0;">Contact Nafil: +91 95447 58339</span>
                            <a href="https://www.instagram.com/nafil.n_/" target="_blank" rel="noopener noreferrer" style="color: #a0a0b0; font-size: 0.9rem; transition: color 0.3s ease;">
                                <i class="fab fa-instagram"></i>
                            </a>
                        </div>
                        <div style="font-size: 0.75rem; color: #8a8a9a; margin: 4px 0;">Idea by Salmanul Farisi</div>
                        <div style="display: flex; align-items: center; gap: 8px; margin: 2px 0;">
                            <span style="font-size: 0.7rem; color: #a0a0b0;">Contact Salman: +91 88915 47160</span>
                            <a href="https://www.instagram.com/salmaneyyi/" target="_blank" rel="noopener noreferrer" style="color: #a0a0b0; font-size: 0.9rem; transition: color 0.3s ease;">
                                <i class="fab fa-instagram"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="footer-links">
                <h4 style="color: #fff; font-size: 1.2rem; margin-bottom: 20px; position: relative; display: block; text-align: left; border-bottom: 2px solid #6a11cb; padding-bottom: 8px; width: 100%;">
                    Quick Links
                </h4>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="margin-bottom: 10px;"><a href="/" style="color: #a0a0b0; text-decoration: none; transition: all 0.3s ease; display: inline-block; position: relative; padding-left: 15px;">
                        <span style="position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 6px; height: 6px; background: #6a11cb; border-radius: 50%; opacity: 0; transition: all 0.3s ease;"></span>
                        Home
                    </a></li>
                    <li style="margin-bottom: 10px;"><a href="/about/" style="color: #a0a0b0; text-decoration: none; transition: all 0.3s ease; display: inline-block; position: relative; padding-left: 15px;">
                        <span style="position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 6px; height: 6px; background: #6a11cb; border-radius: 50%; opacity: 0; transition: all 0.3s ease;"></span>
                        About Us
                    </a></li>
                    <li style="margin-bottom: 10px;"><a href="/news/" style="color: #a0a0b0; text-decoration: none; transition: all 0.3s ease; display: inline-block; position: relative; padding-left: 15px;">
                        <span style="position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 6px; height: 6px; background: #6a11cb; border-radius: 50%; opacity: 0; transition: all 0.3s ease;"></span>
                        News
                    </a></li>
                    <li style="margin-bottom: 10px;"><a href="/gallery/" style="color: #a0a0b0; text-decoration: none; transition: all 0.3s ease; display: inline-block; position: relative; padding-left: 15px;">
                        <span style="position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 6px; height: 6px; background: #6a11cb; border-radius: 50%; opacity: 0; transition: all 0.3s ease;"></span>
                        Gallery
                    </a></li>
                    <li><a href="/contact/" style="color: #a0a0b0; text-decoration: none; transition: all 0.3s ease; display: inline-block; position: relative; padding-left: 15px;">
                        <span style="position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 6px; height: 6px; background: #6a11cb; border-radius: 50%; opacity: 0; transition: all 0.3s ease;"></span>
                        Contact
                    </a></li>
                </ul>
            </div>
            <div class="footer-contact">
                <h4 style="color: #fff; font-size: 1.2rem; margin-bottom: 20px; position: relative; display: block; text-align: left; border-bottom: 2px solid #6a11cb; padding-bottom: 8px; width: 100%;">
                    Contact Us
                </h4>
                <div style="color: #a0a0b0; line-height: 1.7;">
                    <p style="margin: 0 0 15px; display: flex; align-items: flex-start; gap: 10px;">
                        <i class="fas fa-map-marker-alt" style="color: #6a11cb; margin-top: 4px;"></i>
                        <span>Chennamangallur|Mukkam|Kozhikode|Kerala|India</span>
                    </p>
                    <p style="margin: 0 0 15px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-phone" style="transform: scaleX(-1); color: #6a11cb;"></i>
                        <span>+91 98472 91759</span>
                    </p>
                    <p style="margin: 0 0 20px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-envelope" style="color: #6a11cb;"></i>
                        <span>dishamedia8@gmail.com</span>
                    </p>
                    
                    <!-- Social Media Links -->
                    <div class="social-links">
                        <a href="https://www.instagram.com/chennamangallurhsscmr/" target="_blank" rel="noopener noreferrer" 
                           style="color: #a0a0b0; font-size: 1.2rem; transition: all 0.3s ease;">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://www.facebook.com/chennamangallurhss" target="_blank" rel="noopener noreferrer"
                           style="color: #a0a0b0; font-size: 1.2rem; transition: all 0.3s ease;">
                            <i class="fab fa-facebook"></i>
                        </a>
                        <a href="https://www.linkedin.com/school/chennamangallur-hss" target="_blank" rel="noopener noreferrer"
                           style="color: #a0a0b0; font-size: 1.2rem; transition: all 0.3s ease;">
                            <i class="fab fa-linkedin"></i>
                        </a>
                        <a href="https://www.youtube.com/@chennamangallurhss42" target="_blank" rel="noopener noreferrer"
                           style="color: #a0a0b0; font-size: 1.2rem; transition: all 0.3s ease;">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                </div>
                
                <style>
                    .social-links {
                        display: flex;
                        justify-content: flex-start;
                        gap: 15px;
                        margin-top: 20px;
                        flex-wrap: wrap;
                    }
                    .social-links a {
                        position: relative;
                        display: block;
                        width: 40px;
                        height: 40px;
                        border-radius: 50%;
                        background: rgba(255, 255, 255, 0.05);
                        transition: all 0.3s ease;
                        color: #a0a0b0;
                        text-decoration: none;
                    }
                    .social-links a i {
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        font-size: 1.2rem;
                        line-height: 1;
                        width: 1em;
                        height: 1em;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    }
                    .social-links a:hover {
                        transform: translateY(-3px);
                        background: rgba(255, 255, 255, 0.1);
                        text-decoration: none;
                    }
                    .social-links a:hover i.fa-instagram { color: #E1306C !important; }
                    .social-links a:hover i.fa-facebook { color: #1877F2 !important; }
                    .social-links a:hover i.fa-linkedin { color: #0A66C2 !important; }
                    .social-links a:hover i.fa-youtube { color: #FF0000 !important; }
                    
                    /* Mobile-specific styles */
                    @media (max-width: 768px) {
                        .footer-links h4,
                        .footer-contact h4 {
                            text-align: left;
                            width: 100%;
                            padding-bottom: 8px;
                        }
                        .footer-links h4::after,
                        .footer-contact h4::after {
                            content: none;
                        }
                        .footer-links ul {
                            padding-left: 0;
                            text-align: left;
                        }
                        .footer-contact > div {
                            text-align: left;
                        }
                        .social-links {
                            justify-content: flex-start;
                        }
                        .footer-links,
                        .footer-contact {
                            text-align: left;
                        }
                    }
                </style>
            </div>
        </div>
        <div style="border-top: 1px solid rgba(255, 255, 255, 0.1); padding-top: 20px; text-align: center; color: #6b7280; font-size: 0.9rem;">
            <p style="margin: 0;">&copy; 2024 Disha Media - Chennamangaloor HSS. All rights reserved.</p>
        </div>
    </div>
</footer>

<script>
    // Mobile menu toggle with enhanced functionality
    const hamburger = document.getElementById('hamburger');
    const navMenu = document.getElementById('navMenu');
    const body = document.body;
    const closeIcon = document.querySelector('.close-icon');
    const barsIcon = document.querySelector('.fa-bars');

    function toggleMenu() {
        const isActive = hamburger.classList.toggle('active');
        navMenu.classList.toggle('active');
        
        // Toggle body scroll
        if (isActive) {
            body.style.overflow = 'hidden';
            barsIcon.style.display = 'none';
            closeIcon.style.display = 'block';
            closeIcon.style.opacity = '1';
        } else {
            body.style.overflow = '';
            barsIcon.style.display = 'block';
            closeIcon.style.display = 'none';
            closeIcon.style.opacity = '0';
        }
    }

    // Toggle menu on hamburger click
    hamburger.addEventListener('click', toggleMenu);

    // Close menu when clicking on a nav link
    document.querySelectorAll('.nav-item a').forEach(link => {
        link.addEventListener('click', () => {
            if (navMenu.classList.contains('active')) {
                toggleMenu();
            }
        });
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
        const isClickInside = hamburger.contains(e.target) || navMenu.contains(e.target);
        if (!isClickInside && navMenu.classList.contains('active')) {
            toggleMenu();
        }
    });

    // Close menu with Escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && navMenu.classList.contains('active')) {
            toggleMenu();
        }
    });

    // Show modal when Add button is clicked
    document.getElementById('addButton').addEventListener('click', function(e) {
        e.preventDefault();
        const modal = document.getElementById('secretModal');
        modal.style.display = 'flex';
        // Trigger reflow
        void modal.offsetWidth;
        modal.classList.add('active');
        document.getElementById('secretCode').focus();
    });

    function closeModal() {
        const modal = document.getElementById('secretModal');
        modal.classList.remove('active');
        setTimeout(() => {
            modal.style.display = 'none';
            document.getElementById('secretCode').value = '';
            document.getElementById('errorMsg').style.display = 'none';
        }, 300);
    }

    // Function to get CSRF token from cookies
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    function checkCode() {
        const secretCode = document.getElementById('secretCode').value;
        const errorMsg = document.getElementById('errorMsg');
        const modal = document.querySelector('.modal-container');
        const csrftoken = getCookie('csrftoken');
        
        if (secretCode === 'schoolSC') {
            // Set a session variable via AJAX
            fetch("{% url 'web:verify_secret_code' %}", {
                method: 'POST',
                headers: {
                    'X-CSRFToken': csrftoken,
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({code: secretCode}),
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    // Add success animation before redirect
                    modal.style.animation = 'fadeOut 0.5s ease-out';
                    setTimeout(() => {
                        window.location.href = "{% url 'web:add_content' %}";
                    }, 300);
                } else {
                    showError();
                }
            })
            .catch(() => {
                showError();
            });
        } else {
            showError();
        }
        
        function showError() {
            errorMsg.style.display = 'flex';
            modal.style.animation = 'shake 0.5s';
            setTimeout(() => {
                modal.style.animation = '';
            }, 500);
            document.getElementById('secretCode').value = '';
            document.getElementById('secretCode').focus();
        }
    }

    // Close modal when clicking outside
    document.getElementById('secretModal').addEventListener('click', function(e) {
        if (e.target === this) {
            closeModal();
        }
    });

    // Close with Escape key
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeModal();
        }
    });
</script>

</body>
</html>